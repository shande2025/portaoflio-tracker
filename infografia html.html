<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infografía: Tendencias del Mercado de Seguros en Perú</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 450px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        .swot-grid > div {
            border-radius: 0.5rem;
            padding: 1.5rem;
            color: #FFFFFF;
        }
        .flow-step {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 10rem;
            height: 10rem;
            border-radius: 50%;
            text-align: center;
            font-weight: 600;
            color: white;
            padding: 1rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            position: relative;
            z-index: 1;
        }
        .flow-arrow {
            position: absolute;
            font-size: 3rem;
            color: #d1d5db;
            z-index: 0;
        }
        .ai-response {
            margin-top: 1.5rem;
            padding: 1rem;
            background-color: #e0f2f7; /* Light blue from palette */
            border-left: 4px solid #118AB2; /* Blue accent */
            border-radius: 0.25rem;
            color: #073B4C;
            font-style: italic;
        }
        .loading-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #118AB2;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            display: inline-block;
            vertical-align: middle;
            margin-left: 0.5rem;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="text-gray-800">

    <div class="container mx-auto p-4 md:p-8">

        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-extrabold text-[#073B4C] mb-2">Panorama del Mercado de Seguros en Perú</h1>
            <p class="text-xl text-[#118AB2]">Un análisis de tendencias basado en la cartera de productos de Interbank</p>
        </header>

        <section class="mb-16">
            <div class="bg-white rounded-lg shadow-md p-6 md:p-8">
                <h2 class="text-2xl font-bold text-[#073B4C] mb-4">Composición del Mercado de Seguros Personales</h2>
                <p class="mb-6 text-gray-600">Para comprender el mercado, es fundamental analizar la distribución de la demanda entre las principales categorías de seguros. El siguiente gráfico ilustra la participación estimada de cada segmento, mostrando un fuerte enfoque en la protección de la salud y la vida, seguido de cerca por la seguridad vehicular. Estos datos, aunque ilustrativos, reflejan las prioridades de los consumidores peruanos al buscar protección financiera y personal.</p>
                <div class="chart-container mx-auto">
                    <canvas id="marketCompositionChart"></canvas>
                </div>
                <div class="text-center mt-6">
                    <button id="generateMarketInsightBtn" class="bg-[#118AB2] hover:bg-[#073B4C] text-white font-bold py-2 px-4 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                        Generar Perspectiva del Mercado ✨
                    </button>
                    <div id="marketInsightResponse" class="ai-response hidden"></div>
                </div>
            </div>
        </section>

        <section class="mb-16">
            <div class="bg-white rounded-lg shadow-md p-6 md:p-8">
                <h2 class="text-2xl font-bold text-[#073B4C] mb-4">Análisis de la Demanda en Seguros de Salud y Vida</h2>
                <p class="mb-6 text-gray-600">Dentro del segmento más grande, "Salud y Vida", no todas las coberturas tienen el mismo peso para el consumidor. Un análisis de la demanda revela que la cobertura oncológica y los seguros de vida con devolución son altamente valorados. Este gráfico de barras compara la demanda relativa de diferentes coberturas, lo que indica una creciente conciencia sobre la necesidad de protección contra enfermedades graves y la planificación financiera a largo plazo.</p>
                <div class="chart-container mx-auto">
                    <canvas id="demandAnalysisChart"></canvas>
                </div>
            </div>
        </section>

        <section class="mb-16">
            <div class="bg-white rounded-lg shadow-md p-6 md:p-8">
                <h2 class="text-2xl font-bold text-[#073B4C] mb-4">Proyecciones de Crecimiento del Mercado (2025-2029)</h2>
                 <p class="mb-6 text-gray-600">El mercado de seguros no es estático. Las proyecciones indican un crecimiento sostenido, impulsado principalmente por la innovación en productos digitales y la mayor conciencia sobre la prevención. Se espera que los seguros de protección digital y los oncológicos lideren el crecimiento en los próximos cinco años, reflejando cambios en el estilo de vida y las preocupaciones de la población.</p>
                <div class="chart-container mx-auto">
                    <canvas id="growthProjectionChart"></canvas>
                </div>
            </div>
        </section>

        <section class="mb-16">
            <div class="bg-white rounded-lg shadow-md p-6 md:p-8">
                <h2 class="text-2xl font-bold text-[#073B4C] mb-4">Paisaje Competitivo: Análisis SWOT</h2>
                <p class="mb-6 text-gray-600">Un análisis de las Fortalezas, Oportunidades, Debilidades y Amenazas (SWOT) del sector asegurador en Perú revela un entorno dinámico. La fortaleza radica en la diversificación de productos, mientras que la oportunidad principal es la baja penetración del mercado. Las debilidades se centran en la complejidad de los productos, y la principal amenaza es la inestabilidad económica que puede afectar la capacidad de pago de los clientes.</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 swot-grid">
                    <div id="swot-fortalezas" class="bg-[#06D6A0]">
                        <h3 class="font-bold text-xl mb-2">Fortalezas</h3>
                        <ul class="list-disc list-inside">
                            <li>Amplia cartera de productos.</li>
                            <li>Alianzas estratégicas con bancos.</li>
                            <li>Creciente adopción de canales digitales.</li>
                        </ul>
                    </div>
                    <div id="swot-oportunidades" class="bg-[#118AB2]">
                        <h3 class="font-bold text-xl mb-2">Oportunidades</h3>
                        <ul class="list-disc list-inside">
                            <li>Baja penetración de seguros en el país.</li>
                            <li>Crecimiento de la clase media.</li>
                            <li>Demanda de productos de ahorro e inversión.</li>
                        </ul>
                    </div>
                    <div id="swot-debilidades" class="bg-[#FFD166]">
                        <h3 class="font-bold text-xl mb-2 text-[#073B4C]">Debilidades</h3>
                        <ul class="list-disc list-inside text-gray-800">
                            <li>Complejidad percibida en las pólizas.</li>
                            <li>Desconfianza en el sector.</li>
                            <li>Procesos de reclamo pueden ser lentos.</li>
                        </ul>
                    </div>
                    <div id="swot-amenazas" class="bg-[#FF6B6B]">
                        <h3 class="font-bold text-xl mb-2">Amenazas</h3>
                        <ul class="list-disc list-inside">
                            <li>Inestabilidad económica y política.</li>
                            <li>Competencia de nuevos actores (Insurtech).</li>
                            <li>Cambios regulatorios.</li>
                        </ul>
                    </div>
                </div>
                <div class="text-center mt-6">
                    <button id="generateStrategyBtn" class="bg-[#06D6A0] hover:bg-[#073B4C] text-white font-bold py-2 px-4 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                        Sugerir Estrategia Competitiva ✨
                    </button>
                    <div id="strategyResponse" class="ai-response hidden"></div>
                </div>
            </div>
        </section>
        
        <section class="mb-16">
            <div class="bg-white rounded-lg shadow-md p-6 md:p-8">
                 <h2 class="text-2xl font-bold text-[#073B4C] mb-4">Demografía del Consumidor de Seguros</h2>
                 <p class="mb-6 text-gray-600">Los diferentes grupos de edad muestran distintas afinidades por los productos de seguros. Los adultos jóvenes tienden a priorizar seguros vehiculares y de viaje, mientras que los grupos de mayor edad muestran una mayor afinidad por los seguros de vida y de salud. Este análisis es clave para dirigir las estrategias de marketing y desarrollo de productos de manera efectiva.</p>
                <div class="chart-container mx-auto">
                    <canvas id="demographicsChart"></canvas>
                </div>
            </div>
        </section>

        <section class="mb-16">
            <div class="bg-white rounded-lg shadow-md p-6 md:p-8">
                <h2 class="text-2xl font-bold text-[#073B4C] mb-4">Flujo Simplificado del Proceso de Contratación</h2>
                <p class="mb-6 text-gray-600">La simplificación del proceso de contratación es un factor clave para mejorar la experiencia del cliente. El flujo ideal se centra en la claridad y la eficiencia, desde la primera consulta hasta la activación de la póliza. Este diagrama representa los cuatro pasos fundamentales que las aseguradoras buscan optimizar para facilitar el acceso a la protección.</p>
                <div class="relative flex flex-col md:flex-row items-center justify-around w-full p-4 space-y-8 md:space-y-0 md:space-x-8">
                    <div class="flow-step bg-[#FF6B6B]"><span>1. Asesoría y Elección</span></div>
                    <div class="flow-arrow hidden md:block" style="left: 20%; top: 50%; transform: translateY(-50%);">→</div>
                    <div class="flow-arrow block md:hidden" style="top: 18%; left: 50%; transform: translateX(-50%);">↓</div>
                    <div class="flow-step bg-[#FFD166] text-[#073B4C]"><span>2. Solicitud y Evaluación</span></div>
                    <div class="flow-arrow hidden md:block" style="left: 45%; top: 50%; transform: translateY(-50%);">→</div>
                     <div class="flow-arrow block md:hidden" style="top: 43%; left: 50%; transform: translateX(-50%);">↓</div>
                    <div class="flow-step bg-[#06D6A0]"><span>3. Emisión de la Póliza</span></div>
                     <div class="flow-arrow hidden md:block" style="left: 70%; top: 50%; transform: translateY(-50%);">→</div>
                    <div class="flow-arrow block md:hidden" style="top: 68%; left: 50%; transform: translateX(-50%);">↓</div>
                    <div class="flow-step bg-[#118AB2]"><span>4. Activación de Cobertura</span></div>
                </div>
            </div>
        </section>

    </div>

    <script>
        const COLORS = {
            red: '#FF6B6B',
            yellow: '#FFD166',
            green: '#06D6A0',
            blue: '#118AB2',
            darkBlue: '#073B4C'
        };

        function processLabel(label, maxLength = 16) {
            if (label.length <= maxLength) {
                return label;
            }
            const words = label.split(' ');
            const lines = [];
            let currentLine = '';
            words.forEach(word => {
                if ((currentLine + ' ' + word).trim().length > maxLength) {
                    lines.push(currentLine.trim());
                    currentLine = word;
                } else {
                    currentLine += ' ' + word;
                }
            });
            lines.push(currentLine.trim());
            return lines;
        }
        
        const tooltipTitleCallback = (tooltipItems) => {
            const item = tooltipItems[0];
            let label = item.chart.data.labels[item.dataIndex];
            if (Array.isArray(label)) {
                return label.join(' ');
            } else {
                return label;
            }
        };

        const chartOptionsTemplate = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'top',
                    labels: {
                        color: COLORS.darkBlue,
                        font: { size: 14 }
                    }
                },
                tooltip: {
                    callbacks: {
                        title: tooltipTitleCallback
                    },
                    backgroundColor: 'rgba(0, 0, 0, 0.7)',
                    titleFont: { size: 16 },
                    bodyFont: { size: 14 },
                    padding: 10,
                    cornerRadius: 4
                }
            },
            scales: {
                y: {
                    ticks: { color: COLORS.darkBlue },
                    grid: { color: '#e0e0e0' }
                },
                x: {
                    ticks: { color: COLORS.darkBlue },
                    grid: { color: '#e0e0e0' }
                }
            }
        };

        new Chart(document.getElementById('marketCompositionChart'), {
            type: 'doughnut',
            data: {
                labels: ['Salud y Vida', 'Vehiculares', 'Protección de Tarjetas y Digitales', 'Otros Seguros'],
                datasets: [{
                    label: 'Participación de Mercado',
                    data: [40, 30, 20, 10],
                    backgroundColor: [COLORS.blue, COLORS.green, COLORS.yellow, COLORS.red],
                    borderColor: '#ffffff',
                    borderWidth: 2
                }]
            },
            options: { ...chartOptionsTemplate, scales: { x: { display: false }, y: { display: false } } }
        });

        new Chart(document.getElementById('demandAnalysisChart'), {
            type: 'bar',
            data: {
                labels: [
                    processLabel('Seguro Oncológico'), 
                    processLabel('Seguro de Vida con Devolución'), 
                    processLabel('Protección de Créditos'), 
                    processLabel('Renta Hospitalaria')
                ],
                datasets: [{
                    label: 'Índice de Demanda del Consumidor (Puntaje)',
                    data: [85, 80, 70, 60],
                    backgroundColor: [COLORS.red, COLORS.blue, COLORS.yellow, COLORS.green],
                    borderColor: '#ffffff',
                    borderWidth: 1,
                    barPercentage: 0.6,
                    categoryPercentage: 0.7
                }]
            },
            options: { ...chartOptionsTemplate, indexAxis: 'y', scales: { x: { ticks: { color: COLORS.darkBlue } }, y: { ticks: { color: COLORS.darkBlue, font: {size: 12} } } } }
        });

        new Chart(document.getElementById('growthProjectionChart'), {
            type: 'line',
            data: {
                labels: ['2025', '2026', '2027', '2028', '2029'],
                datasets: [
                {
                    label: 'Protección Digital',
                    data: [10, 15, 22, 30, 40],
                    borderColor: COLORS.red,
                    backgroundColor: 'rgba(255, 107, 107, 0.1)',
                    fill: true,
                    tension: 0.3
                },
                {
                    label: 'Seguro Oncológico',
                    data: [18, 20, 25, 28, 35],
                    borderColor: COLORS.blue,
                    backgroundColor: 'rgba(17, 138, 178, 0.1)',
                    fill: true,
                    tension: 0.3
                },
                 {
                    label: 'Vida con Ahorro',
                    data: [15, 17, 19, 22, 25],
                    borderColor: COLORS.green,
                    backgroundColor: 'rgba(6, 214, 160, 0.1)',
                    fill: true,
                    tension: 0.3
                }]
            },
            options: chartOptionsTemplate
        });
        
        new Chart(document.getElementById('demographicsChart'), {
            type: 'radar',
            data: {
                labels: ['Seguro Vehicular', 'Seguro de Vida', 'Seguro de Viaje', 'Protección Digital', 'Seguro Oncológico'],
                datasets: [{
                    label: '20-35 años',
                    data: [8, 4, 9, 7, 3],
                    fill: true,
                    backgroundColor: 'rgba(255, 107, 107, 0.2)',
                    borderColor: COLORS.red,
                    pointBackgroundColor: COLORS.red,
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: COLORS.red
                }, {
                    label: '36-50 años',
                    data: [7, 8, 6, 8, 7],
                    fill: true,
                    backgroundColor: 'rgba(17, 138, 178, 0.2)',
                    borderColor: COLORS.blue,
                    pointBackgroundColor: COLORS.blue,
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: COLORS.blue
                }, {
                    label: '51+ años',
                    data: [5, 9, 4, 5, 9],
                    fill: true,
                    backgroundColor: 'rgba(6, 214, 160, 0.2)',
                    borderColor: COLORS.green,
                    pointBackgroundColor: COLORS.green,
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: COLORS.green
                }]
            },
            options: { ...chartOptionsTemplate, scales: { r: { angleLines: { color: '#e0e0e0' }, grid: { color: '#e0e0e0' }, pointLabels: { font: { size: 12 }, color: COLORS.darkBlue }, ticks: { backdropColor: '#f0f4f8', color: COLORS.darkBlue } } } }
        });

        // LLM Integration
        async function callGeminiAPI(prompt) {
            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
            
            const payload = {
                contents: [{ role: "user", parts: [{ text: prompt }] }]
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    return result.candidates[0].content.parts[0].text;
                } else {
                    console.error("Unexpected API response structure:", result);
                    return "Error: No se pudo generar la respuesta. Inténtalo de nuevo.";
                }
            } catch (error) {
                console.error("Error calling Gemini API:", error);
                return "Error: Fallo en la comunicación con la IA. Por favor, verifica tu conexión.";
            }
        }

        // Market Insight Generator
        document.getElementById('generateMarketInsightBtn').addEventListener('click', async () => {
            const btn = document.getElementById('generateMarketInsightBtn');
            const responseDiv = document.getElementById('marketInsightResponse');
            
            btn.disabled = true;
            responseDiv.innerHTML = '<div class="loading-spinner"></div> Generando perspectiva...';
            responseDiv.classList.remove('hidden');

            const chartData = {
                labels: ['Salud y Vida', 'Vehiculares', 'Protección de Tarjetas y Digitales', 'Otros Seguros'],
                data: [40, 30, 20, 10]
            };
            const prompt = `Basado en la siguiente distribución de participación de mercado en el sector de seguros en Perú:
            - Salud y Vida: ${chartData.data[0]}%
            - Vehiculares: ${chartData.data[1]}%
            - Protección de Tarjetas y Digitales: ${chartData.data[2]}%
            - Otros Seguros: ${chartData.data[3]}%
            
            Genera una perspectiva concisa y clave sobre la composición de este mercado. Enfócate en el segmento dominante y lo que implica para el consumidor peruano.`;

            const insight = await callGeminiAPI(prompt);
            responseDiv.innerHTML = insight;
            btn.disabled = false;
        });

        // Competitive Strategy Suggestor
        document.getElementById('generateStrategyBtn').addEventListener('click', async () => {
            const btn = document.getElementById('generateStrategyBtn');
            const responseDiv = document.getElementById('strategyResponse');
            
            btn.disabled = true;
            responseDiv.innerHTML = '<div class="loading-spinner"></div> Sugiriendo estrategia...';
            responseDiv.classList.remove('hidden');

            const fortalezas = Array.from(document.querySelectorAll('#swot-fortalezas li')).map(li => li.textContent).join(', ');
            const oportunidades = Array.from(document.querySelectorAll('#swot-oportunidades li')).map(li => li.textContent).join(', ');
            const debilidades = Array.from(document.querySelectorAll('#swot-debilidades li')).map(li => li.textContent).join(', ');
            const amenazas = Array.from(document.querySelectorAll('#swot-amenazas li')).map(li => li.textContent).join(', ');

            const prompt = `Considerando el siguiente análisis SWOT para el sector asegurador en Perú:
            Fortalezas: ${fortalezas}
            Oportunidades: ${oportunidades}
            Debilidades: ${debilidades}
            Amenazas: ${amenazas}
            
            Sugiere una estrategia competitiva clave para una aseguradora como Interbank en este mercado. La estrategia debe ser concisa y enfocarse en cómo la empresa puede aprovechar sus fortalezas y oportunidades para mitigar debilidades y amenazas.`;

            const strategy = await callGeminiAPI(prompt);
            responseDiv.innerHTML = strategy;
            btn.disabled = false;
        });
    </script>
</body>
</html>
